(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{906:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(1),i=n.n(a),c=n(63),u=n(70),s=n(15),l=n(29),f=n(17),p=n(937),d=n(157),y=n(5),m=n.n(y),b=n(932),h=n.n(b);function v(e){if(0===e)return"0 B";var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}function g(e){if(!e)return"Unknown error";if(e.response)try{var t=JSON.parse(e.response);if(t.error&&t.error.code&&t.error.message)return t.error.code+" - "+t.error.message}catch(t){return e.response}return e.message||"Unknown error."}function w(e){if(e.length<=132)return!1;var t=new Uint8Array(e.slice(128,132));return Array.from("DICM").every((function(e,n){return e.charCodeAt(0)===t[n]}))}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cancelled=!1}var t,n,r;return t=e,(n=[{key:"get",value:function(){return this.cancelled}},{key:"set",value:function(e){this.cancelled=e}}])&&O(t.prototype,n),r&&O(t,r),e}(),j=n(36);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function P(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){k(a,r,o,i,c,"next",e)}function c(e){k(a,r,o,i,c,"throw",e)}i(void 0)}))}}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o,a;return t=e,(n=[{key:"smartUpload",value:(a=P(regeneratorRuntime.mark((function e(t,n,r,o){var a,i,c,u,s,l,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=1,i=50,0!==(c=Array.from(t)).length){e.next=5;break}throw new Error("No files were provided.");case 5:return u=Math.min(c.length,i),s=!1,l=function(){var e=P(regeneratorRuntime.mark((function e(t,i){var u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=regeneratorRuntime.mark((function e(){var i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.get()){e.next=2;break}return e.abrupt("return",{v:void 0});case 2:if(i=c.slice(0,a),c=c.slice(a),u=null,e.prev=5,!(i.length>1)){e.next=8;break}throw new Error("Not implemented");case 8:if(1!==i.length){e.next=11;break}return e.next=11,f.simpleUpload(i[0],n);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),u=g(e.t0);case 16:if(i.forEach((function(e){return r(e.fileId,u)})),s||0!==c.length){e.next=21;break}return s=!0,t(),e.abrupt("return",{v:void 0});case 21:case"end":return e.stop()}}),e,null,[[5,13]])}));case 1:if(!(c.length>0)){e.next=8;break}return e.delegateYield(u(),"t0",3);case 3:if("object"!==E(l=e.t0)){e.next=6;break}return e.abrupt("return",l.v);case 6:e.next=1;break;case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.next=10,new Promise((function(e){for(var t=0;t<u;t++)l(e)}));case 10:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"simpleUpload",value:(o=P(regeneratorRuntime.mark((function e(t,n){var r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getClient(n),e.next=3,this.readFile(t);case 3:if(o=e.sent,w(a=o.content)){e.next=7;break}throw new Error("This is not a valid DICOM file.");case 7:return e.next=9,r.storeInstances({datasets:[a]});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"readFile",value:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t({name:e.name,size:e.size,type:e.type,content:r.result})},r.onerror=function(e){return n(e)},r.readAsArrayBuffer(e)}))}},{key:"setRetrieveAuthHeaderFunction",value:function(e){this.retrieveAuthHeaderFunc=e}},{key:"getClient",value:function(e){var t=this.retrieveAuthHeaderFunc();return new j.a.DICOMwebClient({url:e,headers:t})}}])&&C(t.prototype,n),r&&C(t,r),e}());n(957);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return r=this,a=(e=x(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==D(a)&&"function"!=typeof a?I(r):a,N(I(n),"state",{status:"Upload",isCancelled:!1,errorsCount:0,files:null,uploadedVolume:null,wholeVolumeStr:null,isFilesListHidden:!0,timeLeft:null,uploadedList:null,totalCount:0,successfullyUploadedCount:0,lastFile:"",uploadContext:null}),N(I(n),"uploadFiles",(function(e){var t=Array.from(e.target.files),r={};t.forEach((function(e,t){var n={id:t,name:e.name,path:e.webkitRelativePath||e.name,size:e.size,error:null,processed:!1,processedInUI:!1};r[t]=n,e.fileId=t}));var o=t.map((function(e){return e.size})).reduce((function(e,t){return e+t})),a=Math.random();n.setState({status:"Uploading...",files:r,uploadedList:[],uploadedVolume:0,lastFile:t[0].name,totalCount:t.length,wholeVolumeStr:v(o),uploadContext:a,cancellationToken:new S});var i=new S;_.setRetrieveAuthHeaderFunction(n.props.retrieveAuthHeaderFunction),_.smartUpload(e.target.files,n.props.url,(function(e,t){return a===n.state.uploadContext&&n.uploadCallback.call(I(n),e,t)}),i)})),N(I(n),"renderTableRow",(function(e){var t=null;return null!==e.error&&(t=o.a.createElement("p",{style:{color:"red"}},e.error)),o.a.createElement("tr",{key:e.id},o.a.createElement("td",{className:"project"},e.name," ",t))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,e),n=t,(r=[{key:"filesLeft",value:function(){return this.state.uploadedList.length+" of "+this.state.totalCount+" files"}},{key:"volumeLeft",value:function(){return v(this.state.uploadedVolume)+" of "+this.state.wholeVolumeStr}},{key:"percents",value:function(){return parseInt(100*this.state.uploadedList.length/Object.keys(this.state.files).length)}},{key:"isFinished",value:function(){return this.state.isCancelled||Object.keys(this.state.files).length===this.state.uploadedList.length}},{key:"errorsMessage",value:function(){var e=1===this.state.errorsCount?" error":" errors";return this.state.errorsCount+e+" while uploading, click for more info"}},{key:"uploadCallback",value:function(e,t){var n=this.state.files[e];if(n.processed=!0,t)n.error=t,this.setState({errorsCount:this.state.errorsCount+1});else{var r=this.state.uploadedVolume+n.size;this.setState({uploadedVolume:r})}this.setState({lastFile:n.name});var o=this.state.uploadedList;o.push(n),this.setState({uploadedList:o})}},{key:"render",value:function(){return null===this.state.files?o.a.createElement("div",{className:"dicom-uploader"},o.a.createElement("div",{className:"button"},o.a.createElement("label",{htmlFor:"file"},o.a.createElement("img",{src:"./assets/Button_File.svg",alt:"upload file"})),o.a.createElement("input",{className:"invisible-input",onChange:this.uploadFiles,type:"file",id:"file",multiple:!0})),o.a.createElement("div",{className:"button"},o.a.createElement("label",{htmlFor:"folder"},o.a.createElement("img",{src:"./assets/Button_Folder.svg",alt:"upload folder"})),o.a.createElement("input",{className:"invisible-input",type:"file",onChange:this.uploadFiles,id:"folder",webkitdirectory:"true",mozdirectory:"true",multiple:!0}))):o.a.createElement("table",{id:"tblProjectList",className:"table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"table-header"},this.percents(),"% ",this.filesLeft()))),o.a.createElement("tbody",{id:"ProjectList"},this.state.uploadedList.map(this.renderTableRow)))}}])&&R(n.prototype,r),a&&R(n,a),t}(r.Component);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}N(F,"propTypes",{id:i.a.string,event:i.a.string,url:i.a.string,retrieveAuthHeaderFunction:i.a.func});var q=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,n=!(o=(e=U(t)).call.apply(e,[this].concat(i)))||"object"!==L(o)&&"function"!=typeof o?M(r):o,H(M(n),"state",{uploaded:!1}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){return this.props.url?o.a.createElement(h.a,{show:this.props.isOpen,onHide:this.props.onClose,"aria-labelledby":"ModalHeader",className:"modal fade themed in",backdrop:!1,size:"md",keyboard:!0},o.a.createElement(h.a.Header,{closeButton:!0},o.a.createElement(h.a.Title,null,this.props.t("Upload DICOM Files"))),o.a.createElement(h.a.Body,null,o.a.createElement(F,{url:this.props.url,retrieveAuthHeaderFunction:this.props.retrieveAuthHeaderFunction}))):null}}])&&A(n.prototype,r),a&&A(n,a),t}(r.Component);H(q,"propTypes",{url:i.a.string,retrieveAuthHeaderFunction:i.a.func,onClose:i.a.func});var z=Object(l.d)("Common")(q),V=function(e){return!0===e.active},Y=Object(u.b)((function(e){var t=e.servers.servers.find(V);return{retrieveAuthHeaderFunction:function(){return s.a.DICOMWeb.getAuthorizationHeader(t)},url:t&&t.qidoRoot}}),null)(z),G=n(923);n(921);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return r=this,a=(e=Q(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==W(a)&&"function"!=typeof a?K(r):a,Z(K(n),"state",{search:""}),Z(K(n),"renderTableRow",(function(e){return o.a.createElement("tr",{key:e.name,className:n.state.highlightedItem===e.name?"noselect active":"noselect",onMouseEnter:function(){n.onHighlightItem(e.name)},onClick:function(){n.props.onSelect(e)}},o.a.createElement("td",{className:"project"},e.name.split("/")[7]))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(t,e),n=t,(r=[{key:"onHighlightItem",value:function(e){this.setState({highlightedItem:e})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.stores,r=e.filter,a=e.error;if(a)return o.a.createElement("p",null,a);var i=o.a.createElement(f.i,{name:"circle-notch",className:"loading-icon-spin loading-icon"});if(t)return i;var c=o.a.createElement("tbody",{id:"StoreList"},n.filter((function(e){return e.name.split("/")[7].toLowerCase().includes(r.toLowerCase())||""==r})).map(this.renderTableRow));return o.a.createElement("table",{id:"tblStoreList",className:"gcp-table table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,this.props.t("DICOM Store")))),n&&c)}}])&&J(n.prototype,r),a&&J(n,a),t}(r.Component);Z($,"propTypes",{stores:i.a.array,loading:i.a.bool.isRequired,error:i.a.string,onSelect:i.a.func}),Z($,"defaultProps",{loading:!0});var ee=Object(l.d)("Common")($);function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ue=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,n=!(o=(e=oe(t)).call.apply(e,[this].concat(i)))||"object"!==te(o)&&"function"!=typeof o?ae(r):o,ce(ae(n),"state",{error:null,loading:!0,stores:[],locations:[],filterStr:""}),n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G.a.setAccessToken(this.props.accessToken),e.next=3,G.a.loadDicomStores(this.props.dataset.name);case 3:if(!(t=e.sent).isError){e.next=7;break}return this.setState({error:t.message}),e.abrupt("return");case 7:this.setState({stores:t.data.dicomStores||[],loading:!1});case 8:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){ne(o,n,r,a,c,"next",e)}function c(e){ne(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.stores,r=t.loading,a=t.error,i=t.filterStr,c=this.props.onSelect;return o.a.createElement("div",null,o.a.createElement("input",{class:"form-control gcp-input",type:"text",value:i,onChange:function(t){return e.setState({filterStr:t.target.value})}}),o.a.createElement(ee,{stores:n,loading:r,error:a,filter:i,onSelect:c}))}}])&&re(n.prototype,r),a&&re(n,a),t}(r.Component);function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ce(ue,"propTypes",{dataset:i.a.object,onSelect:i.a.func,accessToken:i.a.string.isRequired});var me=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return r=this,a=(e=fe(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==se(a)&&"function"!=typeof a?pe(r):a,ye(pe(n),"state",{search:""}),ye(pe(n),"renderTableRow",(function(e){return o.a.createElement("tr",{key:e.name,className:n.state.highlightedItem===e.name?"noselect active":"noselect",onMouseEnter:function(){n.onHighlightItem(e.name)},onClick:function(){n.props.onSelect(e)}},o.a.createElement("td",null,e.name.split("/")[5]))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(t,e),n=t,(r=[{key:"onHighlightItem",value:function(e){this.setState({highlightedItem:e})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.datasets,r=e.filter,a=e.error;if(a)return o.a.createElement("p",null,a);var i=o.a.createElement(f.i,{name:"circle-notch",className:"loading-icon-spin loading-icon"});if(t)return i;var c=o.a.createElement("tbody",{id:"DatasetList"},n.filter((function(e){return e.name.split("/")[5].toLowerCase().includes(r.toLowerCase())||""==r})).map(this.renderTableRow));return o.a.createElement("table",{id:"tblDatasetList",className:"gcp-table table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,this.props.t("Dataset")))),n&&c)}}])&&le(n.prototype,r),a&&le(n,a),t}(r.Component);ye(me,"propTypes",{datasets:i.a.array,loading:i.a.bool,error:i.a.string,onSelect:i.a.func}),ye(me,"defaultProps",{loading:!0});var be=Object(l.d)("Common")(me);function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ee=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,n=!(o=(e=we(t)).call.apply(e,[this].concat(i)))||"object"!==he(o)&&"function"!=typeof o?Oe(r):o,je(Oe(n),"state",{error:null,loading:!0,datasets:[],filterStr:""}),n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Se(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G.a.setAccessToken(this.props.accessToken),e.next=3,G.a.loadDatasets(this.props.project.projectId,this.props.location.locationId);case 3:if(!(t=e.sent).isError){e.next=7;break}return this.setState({error:t.message}),e.abrupt("return");case 7:this.setState({datasets:t.data.datasets||[],loading:!1});case 8:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){ve(o,n,r,a,c,"next",e)}function c(e){ve(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.datasets,r=t.loading,a=t.error,i=t.filterStr,c=this.props.onSelect;return o.a.createElement("div",null,o.a.createElement("input",{class:"form-control gcp-input",type:"text",value:i,onChange:function(t){return e.setState({filterStr:t.target.value})}}),o.a.createElement(be,{datasets:n,loading:r,error:a,filter:i,onSelect:c}))}}])&&ge(n.prototype,r),a&&ge(n,a),t}(r.Component);function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e,t){return(De=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}je(Ee,"propTypes",{project:i.a.object,location:i.a.object,onSelect:i.a.func,accessToken:i.a.string});var xe=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return r=this,a=(e=Ce(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==ke(a)&&"function"!=typeof a?_e(r):a,Re(_e(n),"state",{search:"",highlightedItem:null}),Re(_e(n),"renderTableRow",(function(e){return o.a.createElement("tr",{key:e.projectId,className:n.state.highlightedItem===e.projectId?"noselect active":"noselect",onMouseEnter:function(){n.onHighlightItem(e.projectId)},onClick:function(){n.onHighlightItem(e.projectId),n.props.onSelect(e)}},o.a.createElement("td",null,e.name),o.a.createElement("td",null,e.projectId))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&De(e,t)}(t,e),n=t,(r=[{key:"onHighlightItem",value:function(e){this.setState({highlightedItem:e})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.projects,r=e.filter,a=e.error;if(a)return o.a.createElement("p",null,a);var i=o.a.createElement(f.i,{name:"circle-notch",className:"loading-icon-spin loading-icon"});if(t)return i;var c=r.toLowerCase(),u=n.filter((function(e){return"string"==typeof e.name&&(""===r||e.name.toLowerCase().includes(c))})),s=o.a.createElement("tbody",{id:"ProjectList"},u.map(this.renderTableRow));return o.a.createElement("table",{id:"tblProjectList",className:"gcp-table table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,this.props.t("Project")),o.a.createElement("th",null,this.props.t("ID")))),n&&s)}}])&&Pe(n.prototype,r),a&&Pe(n,a),t}(r.Component);Re(xe,"propTypes",{projects:i.a.array,loading:i.a.bool.isRequired,error:i.a.string,onSelect:i.a.func.isRequired,t:i.a.func}),Re(xe,"defaultProps",{loading:!0});var Ie=Object(l.d)("Common")(xe);function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ue(e,t){return(Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Be=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,n=!(o=(e=Le(t)).call.apply(e,[this].concat(i)))||"object"!==Te(o)&&"function"!=typeof o?Ae(r):o,Me(Ae(n),"state",{error:null,loading:!0,projects:[]}),n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ue(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G.a.setAccessToken(this.props.accessToken),e.next=3,G.a.loadProjects();case 3:if(!(t=e.sent).isError){e.next=7;break}return this.setState({error:t.message}),e.abrupt("return");case 7:this.setState({projects:t.data.projects||[],filterStr:"",loading:!1});case 8:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Ne(o,n,r,a,c,"next",e)}function c(e){Ne(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.projects,r=t.loading,a=t.filterStr,i=t.error,c=this.props.onSelect;return o.a.createElement("div",null,o.a.createElement("input",{class:"form-control gcp-input",type:"text",value:a,onChange:function(t){return e.setState({filterStr:t.target.value})}}),o.a.createElement(Ie,{projects:n,loading:r,filter:a,error:i,onSelect:c}))}}])&&Fe(n.prototype,r),a&&Fe(n,a),t}(r.Component);function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Me(Be,"propTypes",{onSelect:i.a.func,accessToken:i.a.string});var We=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return r=this,a=(e=ze(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==He(a)&&"function"!=typeof a?Ve(r):a,Ge(Ve(n),"state",{search:""}),Ge(Ve(n),"renderTableRow",(function(e){return o.a.createElement("tr",{key:e.locationId,className:n.state.highlightedItem===e.locationId?"noselect active":"noselect",onMouseEnter:function(){n.onHighlightItem(e.locationId)},onClick:function(){n.props.onSelect(e)}},o.a.createElement("td",null,e.name.split("/")[3]))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(t,e),n=t,(r=[{key:"onHighlightItem",value:function(e){this.setState({highlightedItem:e})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.locations,r=e.filter,a=e.error;if(a)return o.a.createElement("p",null,a);var i=o.a.createElement(f.i,{name:"circle-notch",className:"loading-icon-spin loading-icon"});if(t)return i;var c=o.a.createElement("tbody",{id:"LocationList"},n.filter((function(e){return e.name.split("/")[3].toLowerCase().includes(r.toLowerCase())||""==r})).map(this.renderTableRow));return o.a.createElement("table",{id:"tblLocationList",className:"gcp-table table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,this.props.t("Location")))),n&&c)}}])&&qe(n.prototype,r),a&&qe(n,a),t}(r.Component);Ge(We,"propTypes",{locations:i.a.array,loading:i.a.bool.isRequired,error:i.a.string,onSelect:i.a.func}),Ge(We,"defaultProps",{loading:!0});var Je=Object(l.d)("Common")(We);function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ke(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,n=!(o=(e=Ze(t)).call.apply(e,[this].concat(i)))||"object"!==Qe(o)&&"function"!=typeof o?$e(r):o,tt($e(n),"state",{error:null,loading:!0,locations:[],filterStr:""}),n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G.a.setAccessToken(this.props.accessToken),e.next=3,G.a.loadLocations(this.props.project.projectId);case 3:if(!(t=e.sent).isError){e.next=7;break}return this.setState({error:t.message}),e.abrupt("return");case 7:this.setState({locations:t.data.locations||[],loading:!1});case 8:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Ke(o,n,r,a,c,"next",e)}function c(e){Ke(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.locations,r=t.loading,a=t.error,i=t.filterStr,c=this.props.onSelect;return o.a.createElement("div",null,o.a.createElement("input",{class:"form-control gcp-input",type:"text",value:i,onChange:function(t){return e.setState({filterStr:t.target.value})}}),o.a.createElement(Je,{locations:n,loading:r,error:a,filter:i,onSelect:c}))}}])&&Xe(n.prototype,r),a&&Xe(n,a),t}(r.Component);function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ct(e,t){return(ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}tt(nt,"propTypes",{project:i.a.object,onSelect:i.a.func,accessToken:i.a.string});var st=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=at(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==rt(o)&&"function"!=typeof o?it(r):o,ut(it(n),"state",{project:null,location:null,dataset:null,unloading:!1}),ut(it(n),"onProjectSelect",(function(e){n.setState({project:e})})),ut(it(n),"onLocationSelect",(function(e){n.setState({location:e})})),ut(it(n),"onDatasetSelect",(function(e){n.setState({dataset:e})})),ut(it(n),"onProjectClick",(function(){n.setState({dataset:null,location:null,project:null})})),ut(it(n),"onLocationClick",(function(){n.setState({dataset:null,location:null})})),ut(it(n),"onDatasetClick",(function(){n.setState({dataset:null})})),ut(it(n),"onDicomStoreSelect",(function(e){var t=e.name,r=t.split("/"),o={wadoUriRoot:G.a.urlBase+"/".concat(t,"/dicomWeb"),qidoRoot:G.a.urlBase+"/".concat(t,"/dicomWeb"),wadoRoot:G.a.urlBase+"/".concat(t,"/dicomWeb"),project:r[1],location:r[3],dataset:r[5],dicomStore:r[7]};n.props.setServers(o)})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ct(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props.user.access_token,t=this.state,n=t.project,r=t.location,a=t.dataset,i=this.onProjectClick,c=this.onLocationClick,u=this.onDatasetClick,s=this.onProjectSelect,l=this.onLocationSelect,f=this.onDatasetSelect,p=this.onDicomStoreSelect,d=o.a.createElement("div",{className:"gcp-picker--path"},o.a.createElement("span",null,this.props.t("Select a Project")));return n&&(d=o.a.createElement("div",{className:"gcp-picker--path"},o.a.createElement("span",{onClick:i},n.name),n&&r&&o.a.createElement("span",{onClick:c}," ","-> ",r.name.split("/")[3]),n&&r&&a&&o.a.createElement("span",{onClick:u}," ","-> ",a.name.split("/")[5]))),o.a.createElement(o.a.Fragment,null,d,!n&&o.a.createElement(Be,{accessToken:e,onSelect:s}),n&&!r&&o.a.createElement(nt,{accessToken:e,project:n,onSelect:l}),n&&r&&!a&&o.a.createElement(Ee,{accessToken:e,project:n,location:r,onSelect:f}),n&&r&&a&&o.a.createElement(ue,{accessToken:e,dataset:a,onSelect:p}))}}])&&ot(n.prototype,r),a&&ot(n,a),t}(r.Component);ut(st,"propTypes",{id:i.a.string,event:i.a.string,user:i.a.object,canClose:i.a.string,setServers:i.a.func.isRequired});var lt=Object(l.d)("Common")(st),ft=n(926);function pt(e){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vt=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=yt(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==pt(o)&&"function"!=typeof o?mt(r):o,ht(mt(n),"handleEvent",(function(e){var t=ft.a(e,e.dicomstore);n.props.setServers(t),n.props.onClose()})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){return o.a.createElement(h.a,{show:this.props.isOpen,onHide:this.props.onClose,"aria-labelledby":"ModalHeader",className:"modal fade themed in",backdrop:!1,size:"md",keyboard:!0},o.a.createElement(h.a.Header,{closeButton:!0},o.a.createElement(h.a.Title,null,this.props.t("Google Cloud Healthcare API"))),o.a.createElement(h.a.Body,null,o.a.createElement(lt,{setServers:this.handleEvent,user:this.props.user,url:this.props.url})))}}])&&dt(n.prototype,r),a&&dt(n,a),t}(r.Component);ht(vt,"propTypes",{url:i.a.string,user:i.a.object.isRequired,setServers:i.a.func.isRequired,isOpen:i.a.bool.isRequired,onClose:i.a.func}),ht(vt,"defaultProps",{isOpen:!1});var gt=Object(l.d)("Common")(vt),wt=function(e){return!0===e.active},Ot=Object(u.b)((function(e){var t=e.servers.servers.find(wt);return{user:e.oidc&&e.oidc.user,url:t&&t.qidoRoot}}),(function(e){return{setServers:function(t){e({type:"SET_SERVERS",servers:t})}}}))(gt),St=(n(931),n(242)),jt=n(226),Et=n(131);function kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ct(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function _t(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Ct(a,r,o,i,c,"next",e)}function c(e){Ct(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Rt=s.a.utils.urlUtil;function xt(e){var t=e.history,n=e.server,a=e.user,i=e.studyListFunctionsEnabled,c=Dt(Object(l.c)("Common"),1)[0],u=Dt(Object(r.useState)({fieldName:"patientName",direction:"desc"}),2),s=u[0],y=u[1],m=Dt(Object(r.useState)({studyDateTo:null,studyDateFrom:null,patientName:"",patientId:"",accessionNumber:"",studyDate:"",modalities:"",studyDescription:"",patientNameOrId:"",accessionOrModalityOrDescription:"",allFields:""}),2),b=m[0],h=m[1],v=Dt(Object(r.useState)([]),2),g=v[0],w=v[1],O=Dt(Object(r.useState)({isSearchingForStudies:!1,error:null}),2),S=O[0],j=O[1],E=Dt(Object(r.useState)(null),2),k=E[0],P=E[1],C=Dt(Object(r.useState)(25),2),_=C[0],D=C[1],R=Dt(Object(r.useState)(0),2),x=R[0],I=R[1],T=Object(r.useContext)(Et.a),N=Object(f.G)(["(min-width: 1750px)","(min-width: 1000px) and (max-width: 1749px)","(max-width: 999px)"],["large","medium","small"],"small"),F=Object(f.F)(s,200),L=Object(f.F)(b,250),A=T.appConfig,U=void 0===A?{}:A;!n&&U.enableGoogleCloudAdapter&&"DicomStorePicker"!==k&&P("DicomStorePicker"),Object(r.useEffect)((function(){n&&function(){var e=_t(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j({error:null,isSearchingForStudies:!0}),e.next=4,It(n,L,F,_,x,N);case 4:t=e.sent,w(t),j({error:null,isSearchingForStudies:!1}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn(e.t0),j({error:!0,isFetching:!1});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}()()}),[L,F,_,x,N,n]);if(S.error)return o.a.createElement("div",null,"Error: ",JSON.stringify(S.error));if(g===[]&&!k)return o.a.createElement("div",null,"Carregando");var M=null,B=null;U.enableGoogleCloudAdapter&&(!function(e,t,n,r){if(e)return;var o=d.b(t,n);if(Rt.paramString.isValidPath(o)){var a=r.location;(void 0===a?{}:a).pathname!==o&&r.replace(o)}}("DicomStorePicker"===k,U,n,t),B=o.a.createElement(Ot,{isOpen:"DicomStorePicker"===k,onClose:function(){return P(null)}}),M=o.a.createElement("div",{className:"form-inline btn-group pull-right",style:{padding:"20px"}},o.a.createElement("button",{className:"btn btn-primary",onClick:function(){return P("DicomStorePicker")}},c("Change DICOM Store"))));return o.a.createElement(o.a.Fragment,null,i?o.a.createElement(Y,{isOpen:"DicomFilesUploader"===k,onClose:function(){return P(null)}}):null,B,o.a.createElement(jt.a.Consumer,null,(function(e){return o.a.createElement(St.a.Consumer,null,(function(t){return o.a.createElement(p.a,{home:!0,user:a,userManager:t},e.logoComponent)}))})),o.a.createElement("div",{className:"study-list-header"},o.a.createElement("div",{className:"header"},o.a.createElement("h1",{style:{fontWeight:300,paddingTop:"7px",fontSize:"22px"}},"Lista de Exames")),o.a.createElement("div",{className:"actions"},i&&M,i&&o.a.createElement(f.p,{onImport:function(){return P("DicomFilesUploader")}}),o.a.createElement("span",{className:"study-count"},g.length))),o.a.createElement("div",{className:"table-head-background"}),o.a.createElement("div",{className:"study-list-container"},o.a.createElement(f.x,{isLoading:S.isSearchingForStudies,hasError:!0===S.error,studies:g,onSelectItem:function(e){var r=d.c(U,n,{studyInstanceUids:e});t.push(r)},sort:s,onSort:function(e){var t=e,n="asc";e===s.fieldName&&("asc"===s.direction?n="desc":(t=null,n=null)),y({fieldName:t,direction:n})},filterValues:b,onFilterChange:function(e,t){h((function(n){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kt(n,!0).forEach((function(t){Pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n,Pt({},e,t))}))},studyListDateFilterNumDays:U.studyListDateFilterNumDays,displaySize:N}),o.a.createElement(f.A,{currentPage:x,nextPageFunc:function(){return I(x+1)},prevPageFunc:function(){return I(x-1)},onRowsPerPageChange:function(e){return D(e)},rowsPerPage:_,recordCount:g.length})))}function It(e,t,n,r,o,a){return Tt.apply(this,arguments)}function Tt(){return(Tt=_t(regeneratorRuntime.mark((function e(t,n,r,o,a,i){var c,u,s,l,f,p,d,y,b,h,v,g,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.allFields,u=n.patientNameOrId,s=n.accessionOrModalityOrDescription,l=r.fieldName||"patientName",f=r.direction||"desc",p=n.studyDateFrom||m()().subtract(25e3,"days").toDate(),d=n.studyDateTo||new Date,y={patientId:n.patientId,patientName:n.patientName,accessionNumber:n.accessionNumber,studyDescription:n.studyDescription,modalitiesInStudy:n.modalities,studyDateFrom:p,studyDateTo:d,limit:o,offset:a*o,fuzzymatching:!0===t.supportsFuzzyMatching},e.next=8,Ft(t,y,i,{allFields:c,patientNameOrId:u,accessionOrModalityOrDescription:s});case 8:return b=e.sent,h=b.map((function(e){var t="string"==typeof e.patientName?e.patientName:void 0;return{accessionNumber:e.accessionNumber,modalities:e.modalities,patientId:e.patientId,patientName:t,studyDate:e.studyDate,studyDescription:e.studyDescription,studyInstanceUid:e.studyInstanceUid}})),v=Nt(h,{allFields:"patientName",patientNameOrId:"patientName",accessionOrModalityOrDescription:"modalities"}[l]||l,f),g=v.length<o?v.length:o,w=v.slice(0,g),e.abrupt("return",w);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nt(e,t,n){var r=e.map((function(e){return m()(e.studyDate,"MMM DD, YYYY",!0).isValid()||(e.studyDate=m()(e.studyDate,"YYYYMMDD").format("MMM DD, YYYY")),e}));return r.sort((function(e,r){var o=e[t],a=r[t];return"studyDate"===t&&(o=m()(o).toISOString(),a=m()(a).toISOString()),"desc"===n?o<a?-1:o>a?1:0:o>a?-1:o<a?1:0})),r}function Ft(e,t,n,r){return Lt.apply(this,arguments)}function Lt(){return(Lt=_t(regeneratorRuntime.mark((function e(t,n,r,o){var a,i,c,u,l,f,p,d,y,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.allFields,i=o.patientNameOrId,c=o.accessionOrModalityOrDescription,u=[n],"small"===r?(l=At(n,["patientId","patientName","accessionNumber","studyDescription","modalitiesInStudy"],a)).length&&(u=l):"medium"===r&&(f=At(n,["patientId","patientName"],i),p=At(n,["accessionNumber","studyDescription","modalitiesInStudy"],c),(f.length||p.length)&&(u=f.concat(p))),d=[],u.forEach((function(e){var n=s.a.studies.searchStudies(t,e);d.push(n)})),e.next=7,Promise.all(d);case 7:return y=e.sent,m=[],y.forEach((function(e){e&&e.forEach((function(e){m.some((function(t){return t.studyInstanceUid===e.studyInstanceUid}))||m.push(e)}))})),e.abrupt("return",m);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function At(e,t,n){var r=[];return""!==n&&n?(t.forEach((function(t){var o=Object.assign({patientId:"",patientName:"",accessionNumber:"",studyDescription:"",modalitiesInStudy:""},e);o[t]=n,r.push(o)})),r):r}xt.propTypes={filters:i.a.object,patientId:i.a.string,server:i.a.object,user:i.a.object,history:i.a.object,studyListFunctionsEnabled:i.a.bool},xt.defaultProps={studyListFunctionsEnabled:!0};var Ut=Object(c.f)(xt),Mt=function(e){return!0===e.active},Bt=Object(u.b)((function(e){return{server:e.servers.servers.find(Mt),user:e.oidc.user}}),null)(Ut),Ht=n(927),qt=s.a.utils.urlUtil;function zt(e){var t=e.match,n=e.location,a=t.params,i=a.project,c=a.location,u=a.dataset,s=a.dicomStore,l=(a.studyInstanceUids,a.seriesInstanceUids,Object(Ht.a)({project:i,location:c,dataset:u,dicomStore:s}),Object(r.useContext)(Et.a).appConfig),f=void 0===l?{}:l,p=qt.queryString.getQueryFilters(n),d=!1;return f.studyListFunctionsEnabled&&(d=f.studyListFunctionsEnabled),o.a.createElement(Bt,{filters:p,studyListFunctionsEnabled:d})}zt.propTypes={location:i.a.shape({search:i.a.string}).isRequired};t.default=Object(c.f)(zt)},921:function(e,t,n){},922:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e}),[e]),t.current}},923:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){i(a,r,o,c,u,"next",e)}function u(e){i(a,r,o,c,u,"throw",e)}c(void 0)}))}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,a,i,s,l,f;return t=e,(n=[{key:"setAccessToken",value:function(e){e||console.error("Access token is empty"),this.accessToken=e}},{key:"getUrlBaseDicomWeb",value:function(e,t,n,r){return this.urlBase+"/projects/".concat(e,"/locations/").concat(t,"/datasets/").concat(n,"/dicomStores/").concat(r,"/dicomWeb")}},{key:"getUrlPath",value:function(e,t,n,r){"/projects/".concat(e,"/locations/").concat(t,"/datasets/").concat(n,"/dicomStores/").concat(r)}},{key:"doRequest",value:(f=c(regeneratorRuntime.mark((function e(t){var n,r,a,i,c,u,s,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=l.length>2&&void 0!==l[2]?l[2]:{},a=new URL(t),i=null,a.search=new URLSearchParams(r),e.prev=5,e.next=8,fetch(a,o({},this.fetchConfig,{config:n}));case 8:return c=e.sent,e.prev=9,e.next=12,c.json();case 12:i=e.sent,e.next=17;break;case 15:e.prev=15,e.t0=e.catch(9);case 17:if(!(c.status>=200&&c.status<300&&null!=i)){e.next=27;break}if(null==i.nextPageToken){e.next=24;break}return r.pageToken=i.nextPageToken,e.next=22,this.doRequest(t,n,r);case 22:for(s in u=e.sent,i)i.hasOwnProperty(s)&&(i[s]=i[s].concat(u.data[s]));case 24:return e.abrupt("return",{isError:!1,status:c.status,data:i});case 27:return e.abrupt("return",{isError:!0,status:c.status,message:i&&i.error&&i.error.message||"Unknown error"});case 28:e.next=35;break;case 30:if(e.prev=30,e.t1=e.catch(5),!i||!i.error){e.next=34;break}return e.abrupt("return",{isError:!0,status:e.t1.status,message:e.t1.response.data.error.message||"Unspecified error"});case 34:return e.abrupt("return",{isError:!0,message:e.t1&&e.t1.message||"Oops! Something went wrong"});case 35:case"end":return e.stop()}}),e,this,[[5,30],[9,15]])}))),function(e){return f.apply(this,arguments)})},{key:"loadProjects",value:(l=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doRequest("https://cloudresourcemanager.googleapis.com/v1/projects"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"loadLocations",value:(s=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doRequest("".concat(this.urlBaseProject,"/").concat(t,"/locations")));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"loadDatasets",value:(i=c(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doRequest("".concat(this.urlBaseProject,"/").concat(t,"/locations/").concat(n,"/datasets")));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"loadDicomStores",value:(a=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doRequest("".concat(this.urlBase,"/").concat(t,"/dicomStores")));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetchConfig",get:function(){if(!this.accessToken)throw new Error("OIDC access_token is not set");return{method:"GET",headers:{Authorization:"Bearer "+this.accessToken}}}},{key:"urlBase",get:function(){return this.healthcareApiEndpoint||"https://healthcare.googleapis.com/v1beta1"},set:function(e){this.healthcareApiEndpoint=e}},{key:"urlBaseProject",get:function(){return this.urlBase+"/projects"}}])&&u(t.prototype,n),r&&u(t,r),e}();t.a=new s},926:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));var r=function(e,t){var n=e.wadoUriRoot,r=e.qidoRoot,o=e.wadoRoot,a=e.dataset,i=void 0===a?"":a,c=e.dicomStore,u=void 0===c?"":c,s=e.location,l=void 0===s?"":s,f=e.project;return[{name:t,dataset:i,dicomStore:u,location:l,project:void 0===f?"":f,imageRendering:"wadors",thumbnailRendering:"wadors",type:"dicomWeb",active:!0,wadoUriRoot:n,qidoRoot:r,wadoRoot:o,supportsFuzzyMatching:!1,qidoSupportsIncludeField:!1}]},o=function(e){return e&&!!e.dataset&&!!e.dicomStore&&!!e.location&&!!e.project},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.keys(e).length,r=Object.keys(t).length;return!(!n||!r)&&(e.dataset===t.dataset&&e.dataset===t.dataset&&e.dicomStore===t.dicomStore&&e.location===t.location&&e.project===t.project)}},927:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(0),o=n(923),a=n(922),i=n(926),c=n(70),u=(n(217),n(131)),s=function(e){return e&&e.servers&&e.servers.find((function(e){return!0===e.active}))},l=function(e,t,n,r,a){var c=[];if(e.enableGoogleCloudAdapter){o.a.urlBase=e.healthcareApiEndpoint;var u=o.a.getUrlBaseDicomWeb(t,n,r,a),s={project:t,location:n,dataset:r,dicomStore:a,wadoUriRoot:u,qidoRoot:u,wadoRoot:u};if(c=i.a(s,a),!f(c[0],e))return}return c},f=function(e,t){return t.enableGoogleCloudAdapter?i.c(e):!!e},p=function(e,t){e({type:"SET_SERVERS",servers:t})},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;arguments.length>5&&arguments[5],arguments.length>6&&arguments[6],arguments.length>7&&arguments[7],arguments.length>8&&arguments[8];if(!o.enableGoogleCloudAdapter)return!1;var a=t!==e&&t;if(a)return!1;if(!r||!r.length)return!1;if(!e.length||!n)return!0;var c=r[0],u=e.some(i.b.bind(void 0,c));return!u};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.project,n=e.location,o=e.dataset,i=e.dicomStore,y=Object(c.d)((function(e){return e&&e.servers})),m=Object(a.a)(y),b=Object(c.c)(),h=Object(r.useContext)(u.a).appConfig,v=void 0===h?{}:h,g=s(y),w=l(v,t,n,o,i)||[];if(d(y.servers,m,g,w,v,t,n,o,i))p(b,w);else if(f(g,v))return g}},931:function(e,t,n){"use strict";var r=n(51),o=n.n(r);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=void 0,(n="fileType")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}var t,n,r;return t=e,(n=[{key:"loadFile",value:function(e,t){}},{key:"getDataset",value:function(e,t){}},{key:"getStudies",value:function(e,t){}}])&&a(t.prototype,n),r&&a(t,r),e}();function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=new(function(e){function t(){var e,n,r,o,a,i,u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var f=arguments.length,p=new Array(f),d=0;d<f;d++)p[d]=arguments[d];return r=this,n=!(o=(e=s(t)).call.apply(e,[this].concat(p)))||"object"!==c(o)&&"function"!=typeof o?l(r):o,a=l(n),u="application/pdf",(i="fileType")in a?Object.defineProperty(a,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):a[i]=u,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(r=[{key:"loadFile",value:function(e,t){return o.a.wadouri.loadFileRequest(t)}},{key:"getDataset",value:function(e,t){var n={};return n.imageId=e.imageId||t,n}},{key:"getStudies",value:function(e,t){return this.getDefaultStudy(t)}},{key:"getDefaultStudy",value:function(e){return{studyInstanceUid:"",studyDate:"",studyTime:"",accessionNumber:"",referringPhysicianName:"",patientName:"",patientId:"",patientBirthdate:"",patientSex:"",studyId:"",studyDescription:"",seriesList:[{seriesInstanceUid:"",seriesDescription:"",seriesNumber:"",instances:[{sopInstanceUid:"",sopClassUid:"1.2.840.10008.5.1.4.1.1.104.1",rows:"",columns:"",numberOfFrames:0,instanceNumber:1,getImageId:function(){return e},isLocalFile:!0}]}]}}}])&&u(n.prototype,r),a&&u(n,a),t}(i)),d=n(66);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=new(function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];return r=this,n=!(o=(e=b(t)).call.apply(e,[this].concat(s)))||"object"!==y(o)&&"function"!=typeof o?h(r):o,a=h(n),c="application/dicom",(i="fileType")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),n=t,(r=[{key:"loadFile",value:function(e,t){return o.a.wadouri.loadFileRequest(t)}},{key:"getDataset",value:function(e,t){var n={};try{var r=d.b.DicomMessage.readFile(e);(n=d.b.DicomMetaDictionary.naturalizeDataset(r.dict))._meta=d.b.DicomMetaDictionary.namifyDataset(r.meta)}catch(e){console.error("Error reading dicom file",e)}return n.imageId=t,n}},{key:"getStudies",value:function(e,t){return this.getStudyFromDataset(e)}},{key:"getStudyFromDataset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.StudyInstanceUID,n=e.StudyDate,r=e.StudyTime,o=e.AccessionNumber,a=e.ReferringPhysicianName,i=e.PatientName,c=e.PatientID,u=e.PatientBirthDate,s=e.PatientSex,l=e.StudyID,f=e.StudyDescription,p=e.SeriesInstanceUID,d=e.SeriesDescription,y=e.SeriesNumber,m=e.SOPInstanceUID,b=e.SOPClassUID,h=e.Rows,v=e.Columns,g=e.NumberOfFrames,w=e.InstanceNumber,O=e.imageId,S=e.Modality,j={sopInstanceUid:m,sopClassUid:b,rows:h,columns:v,numberOfFrames:g,instanceNumber:w,url:O,modality:S},E={seriesInstanceUid:p,seriesDescription:d,seriesNumber:y,instances:[j]},k={studyInstanceUid:t,studyDate:n,studyTime:r,accessionNumber:o,referringPhysicianName:a,patientName:i,patientId:c,patientBirthdate:u,patientSex:s,studyId:l,studyDescription:f,seriesList:[E]};return k}}])&&m(n.prototype,r),a&&m(n,a),t}(i));function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(o=E(t).call(this))||"object"!==w(o)&&"function"!=typeof o?k(r):o,C(k(n),"fileType",void 0),C(k(n),"loader",void 0);var a=e&&e.type;return n.loader=n.getLoader(a),n.fileType=n.loader.fileType,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,e),n=t,a=[{key:"groupSeries",value:function(e){var t=function(e,t,n){var r=1;return e.reduce((function(e,o){var a,i=o[t],c=o[n];return e[i=i||""+r++]||(e[i]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},o),e[i][n]=[]),(a=e[i][n]).push.apply(a,O(c)),e}),{})};return Object.values(t(e,"studyInstanceUid","seriesList")).map((function(e){var n=t(e.seriesList,"seriesInstanceUid","instances");return e.seriesList=Object.values(n),e}))}}],(r=[{key:"addFile",value:function(e){return o.a.wadouri.fileManager.add(e)}},{key:"loadFile",value:function(e,t){return this.loader.loadFile(e,t)}},{key:"getDataset",value:function(e,t){return this.loader.getDataset(e,t)}},{key:"getStudies",value:function(e,t){return this.loader.getStudies(e,t)}},{key:"getLoader",value:function(e){return"application/pdf"===e?p:g}}])&&j(n.prototype,r),a&&j(n,a),t}(i);function D(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function R(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){D(a,r,o,i,c,"next",e)}function c(e){D(a,r,o,i,c,"throw",e)}i(void 0)}))}}n.d(t,"a",(function(){return I}));var x=function(){var e=R(regeneratorRuntime.mark((function e(t){var n,r,o,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new _(t),r=n.addFile(t),e.next=5,n.loadFile(t,r);case 5:return o=e.sent,e.next=8,n.getDataset(o,r);case 8:return a=e.sent,e.next=11,n.getStudies(a,r);case 11:return i=e.sent,e.abrupt("return",i);case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0.name,":Error when trying to load and process local files:",e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}();function I(e){return T.apply(this,arguments)}function T(){return(T=R(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(x),e.next=3,Promise.all(n);case 3:return r=e.sent,e.abrupt("return",_.groupSeries(r.flat()));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},957:function(e,t,n){}}]);
//# sourceMappingURL=StudyListRouting.bundle.53fbb8654c6998b346be.js.map