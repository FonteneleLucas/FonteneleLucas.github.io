(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{907:function(e,t,n){"use strict";n.r(t);var r=n(70),a=n(0),s=n.n(a),i=n(119),o=n(61),c=n(6),u=n(1),d=n.n(u),f=n(928),l=n.n(f),p=n(241),y=n(924),v=n(925),h=n(480);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t,n,r,a,s,i){try{var o=e[s](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(r,a)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U=i.a.studyMetadataManager,j=i.a.updateMetaDataManager,A=o.a.OHIFStudyMetadata,R=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=this,n=!(a=(e=S(t)).call.apply(e,[this].concat(i)))||"object"!==b(a)&&"function"!=typeof a?w(r):a,O(w(n),"state",{studies:null,server:null,studyInstanceUids:null,seriesInstanceUids:null,error:null,loading:!0}),n}var n,r,a,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,e),n=t,(r=[{key:"parseQueryAndRetrieveDICOMWebData",value:function(e){var t=this;return new Promise((function(n,r){var a=e.url;if(!a)return r(new Error("No URL was specified. Use ?url=$yourURL"));var s=new XMLHttpRequest;s.addEventListener("error",(function(e){c.a.warn("An error occurred while retrieving the JSON data"),r(e)})),s.addEventListener("load",(function(a){404===a.target.status&&r(new Error("No JSON data found")),s.responseText||(c.a.warn("Response was undefined"),r(new Error("Response was undefined"))),c.a.info(JSON.stringify(s.responseText,null,2));var i=JSON.parse(s.responseText);if(i.servers){e.studyInstanceUids||(c.a.warn("No study instance uids specified"),r(new Error("No study instance uids specified")));var o=i.servers.dicomWeb[0];o.type="dicomWeb",c.a.warn("Activating server",o),t.props.activateServer(o);var u=e.studyInstanceUids.split(";"),d=e.seriesInstanceUids?e.seriesInstanceUids.split(";"):[];n({server:o,studyInstanceUids:u,seriesInstanceUids:d})}else n({studies:i.studies,studyInstanceUids:[]})})),c.a.info("Sending Request to: ".concat(a)),s.open("GET",a),s.setRequestHeader("Accept","application/json"),s.send()}))}},{key:"componentDidMount",value:(i=regeneratorRuntime.mark((function e(){var t,n,r,a,s,i,o,c,u,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(t=this.props.location.search).slice(1,t.length),n=l.a.parse(t),e.next=6,this.parseQueryAndRetrieveDICOMWebData(n);case 6:r=e.sent,a=r.server,s=r.studies,i=r.studyInstanceUids,o=r.seriesInstanceUids,s&&(c=E(s),u=c.studies,d=c.studyInstanceUids,s=u,i=d),this.setState({studies:s,server:a,studyInstanceUids:i,seriesInstanceUids:o,loading:!1}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),this.setState({error:e.t0.message,loading:!1});case 18:case"end":return e.stop()}}),e,this,[[0,15]])})),o=function(){var e=this,t=arguments;return new Promise((function(n,r){var a=i.apply(e,t);function s(e){m(a,n,r,s,o,"next",e)}function o(e){m(a,n,r,s,o,"throw",e)}s(void 0)}))},function(){return o.apply(this,arguments)})},{key:"render",value:function(){var e=this.state.error?"Error: ".concat(JSON.stringify(this.state.error)):"Carregando...";return this.state.error||this.state.loading?s.a.createElement(h.a,{message:e,showGoBackButton:this.state.error}):this.state.studies?s.a.createElement(y.a,{studies:this.state.studies}):s.a.createElement(v.a,{studyInstanceUids:this.state.studyInstanceUids,seriesInstanceUids:this.state.seriesInstanceUids,server:this.state.server})}}])&&g(n.prototype,r),a&&g(n,a),t}(a.Component);O(R,"propTypes",{location:d.a.object,store:d.a.object,setServers:d.a.func});var E=function(e){U.purge();var t=new Set;return{studies:e.map((function(e){var n=new A(e,e.studyInstanceUid),r=p.c.modules.sopClassHandlerModule;return e.displaySets=e.displaySets||n.createDisplaySets(r),n.setDisplaySets(e.displaySets),j(e),U.add(n),t.add(e.studyInstanceUid),e})),studyInstanceUids:Array.from(t)}},D=R,C=Object(r.b)(null,(function(e){return{activateServer:function(t){e({type:"ACTIVATE_SERVER",server:t})}}}))(D);t.default=C},922:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e}),[e]),t.current}},925:function(e,t,n){"use strict";var r=n(70),a=n(0),s=n.n(a),i=n(61),o=n(153),c=n(119),u=n(6),d=n(922),f=n(924),l=n(1),p=n.n(l),y=n(241),v=n(17),h=n(131);function b(e,t,n,r,a,s,i){try{var o=e[s](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(r,a)}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,s=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,s=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw s}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var S=i.a.OHIFStudyMetadata,w=i.a.OHIFSeriesMetadata,I=o.a.retrieveStudiesMetadata,O=o.a.deleteStudyMetadataPromise,U=c.a.studyMetadataManager,j=c.a.updateMetaDataManager,A=c.a.makeCancelable,R=function(e,t,n,r){var a=!1;return r||(k(e,t),a=E(e,t,n)),a},E=function(e,t,n){var r=!1;if(Object.keys(n).length>0){var a=n.seriesInstanceUID,s=function(e,t,n){var r=g(e),a=!1,s=r.findIndex(n.bind(void 0,t));if(s>0){var i=r.splice(s,1);r=[].concat(g(i),g(r))}return s>=0&&(a=!0),{promoted:a,data:r}}(t.getDisplaySets(),a,(function(e,t){return t.seriesInstanceUid===e}));e.displaySets=s.data,r=s.promoted}return r},D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.seriesInstanceUID,a=!0;if(!r)return a;var s=e.seriesList,i=void 0===s?[]:s,o=e.displaySets,c=void 0===o?[]:o,u=n?i[0]:c[0];return u&&u.seriesInstanceUid===r||(a=!1),a},C=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e){var r=n.show,a=void 0===r?function(){}:r;a({message:t})}},x=function(e,t){var n=y.c.modules.sopClassHandlerModule,r=e.getData(),a=new w(t,r);e.addSeries(a),e.createAndAddDisplaySetsForSeries(n,a,!1),r.displaySets=e.getDisplaySets(),M(r,t.seriesInstanceUid)},M=function(e,t,n){j(e,n);var r=e.studyInstanceUid;U.get(r)||U.add(t)},P=function(e,t){var n=y.c.modules.sopClassHandlerModule;e.displaySets||(e.displaySets=t.createDisplaySets(n)),t.setDisplaySets(e.displaySets)},k=function(e,t){t.sortDisplaySets(e.displaySets)},T=function(e){var t=e.getData().seriesLoader;if(!t)return Promise.resolve();for(var n=[];t.hasNext();)n.push(t.next().then((function(t){x(e,t)}),(function(e){u.a.error(e)})));return Promise.all(n)};function N(e){var t,n,r=e.server,i=e.studyInstanceUids,o=e.seriesInstanceUids,c=e.clearViewportSpecificData,l=m(Object(a.useState)(!1),2),p=l[0],y=l[1],w=m(Object(a.useState)([]),2),j=w[0],E=w[1],x=m(Object(a.useState)(!1),2),k=x[0],N=x[1],H=Object(v.H)(),_=Object(a.useContext)(h.a).appConfig,J=(void 0===_?{}:_).filterQueryParam,L=void 0!==J&&J,V=function(e,n){if(Array.isArray(e)&&e.length>0){var r=e.map((function(e){var r=new S(e,e.studyInstanceUid);return P(e,r),M(e,r),t[e.studyInstanceUid]=A(T(r)).then((function(t){t&&!t.isCanceled&&function(e,t,n){R(e,t,n,L)&&c(0);var r=D(e,n,L);C(r,"Query parameters were not applied. Using original series list for given study.",H),E([].concat(g(j),[e])),N(!0)}(e,r,n)})).catch((function(e){e&&!e.isCanceled&&(y(!0),u.a.error(e))})),e}));E(r)}},q=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t={},a=o&&o[0],s=[r,i],a&&(t.seriesInstanceUID=a,L&&s.push(t)),n[i]=A(I.apply(void 0,s)).then((function(e){e&&!e.isCanceled&&V(e,t)})).catch((function(e){e&&!e.isCanceled&&(y(!0),u.a.error(e))}))}catch(e){e&&(y(!0),u.a.error(e))}case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function i(e){b(s,r,a,i,o,"next",e)}function o(e){b(s,r,a,i,o,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),F=function(){for(var e in n)"cancel"in n[e]&&n[e].cancel();for(var r in t)"cancel"in t[r]&&(t[r].cancel(),O(r),U.remove(r))},Q=Object(d.a)(i);return Object(a.useEffect)((function(){!(Q&&Q.every((function(e){return i.includes(e)})))&&(U.purge(),F())}),[i]),Object(a.useEffect)((function(){return t={},n={},q(),function(){F()}}),[]),p?s.a.createElement("div",null,"Error: ",JSON.stringify(p)):s.a.createElement(f.a,{studies:j,isStudyLoaded:k,studyInstanceUids:i})}N.propTypes={studyInstanceUids:p.a.array.isRequired,seriesInstanceUids:p.a.array,server:p.a.object,clearViewportSpecificData:p.a.func.isRequired};var H=N,_=n(15).a.redux.actions.clearViewportSpecificData,J=function(e){return!0===e.active},L=Object(r.b)((function(e,t){var n=e.servers.servers.find(J);return{server:t.server||n}}),(function(e){return{clearViewportSpecificData:function(){e(_())}}}))(H);t.a=L},928:function(e,t,n){"use strict";t.decode=t.parse=n(929),t.encode=t.stringify=n(930)},929:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,s){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var c=1e3;s&&"number"==typeof s.maxKeys&&(c=s.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var d=0;d<u;++d){var f,l,p,y,v=e[d].replace(o,"%20"),h=v.indexOf(n);h>=0?(f=v.substr(0,h),l=v.substr(h+1)):(f=v,l=""),p=decodeURIComponent(f),y=decodeURIComponent(l),r(i,p)?a(i[p])?i[p].push(y):i[p]=[i[p],y]:i[p]=y}return i};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},930:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,o){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?s(i(e),(function(i){var o=encodeURIComponent(r(i))+n;return a(e[i])?s(e[i],(function(e){return o+encodeURIComponent(r(e))})).join(t):o+encodeURIComponent(r(e[i]))})).join(t):o?encodeURIComponent(r(o))+n+encodeURIComponent(r(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function s(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}}}]);
//# sourceMappingURL=ConnectedStandaloneRouting.bundle.47a516c55084ad83459c.js.map